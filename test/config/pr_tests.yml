
defaultTestCaseConfig:
  launchCommand: nnictl create --config $configFile
  stopCommand: nnictl stop
  experimentStatusCheck: True
  platform: linux darwin win32

testCases:

#########################################################################
# nni features test
#########################################################################
- name: metrics-float
  configFile: test/config/metrics_test/config.yml
  config:
    maxTrialNum: 1
    trialConcurrency: 1
  validator:
    class: MetricsValidator
    kwargs:
      expected_result_file: expected_metrics.json

# to be enabled
#- name: metrics-dict
#  configFile: test/config/metrics_test/config_dict_metrics.yml
#  config:
#    maxTrialNum: 1
#    trialConcurrency: 1
#  validator:
#    class: MetricsValidator
#    kwargs:
#      expected_result_file: expected_metrics_dict.json

- name: nnicli
  configFile: test/config/examples/sklearn-regression.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
  launchCommand: python3 -c 'import nnicli as nc; nc.start_nni("$configFile")'
  stopCommand: python3 -c 'import nnicli as nc; nc.stop_nni()'
  validator:
    class: NnicliValidator
  platform: linux darwin

- name: multi-thread
  configFile: test/config/multi_thread/config.yml

- name: multi-phase-batch
  configFile: test/config/multi_phase/batch.yml
  config:
    # for batch tuner, maxTrialNum can not exceed length of search space
    maxTrialNum: 2
    trialConcurrency: 2

#########################################################################
# nni assessor test
#########################################################################
- name: assessor-curvefitting
  configFile: test/config/assessors/curvefitting.yml

- name: assessor-medianstop
  configFile: test/config/assessors/medianstop.yml

#########################################################################
# nni tuners test
#########################################################################
- name: tuner-annel
  configFile: test/config/tuners/anneal.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-evolution
  configFile: test/config/tuners/evolution.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-random
  configFile: test/config/tuners/random.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-smac
  configFile: test/config/tuners/smac.yml
  platform: linux darwin
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-tpe
  configFile: test/config/tuners/tpe.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-batch
  configFile: test/config/tuners/batch.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-bohb
  configFile: test/config/tuners/bohb.yml
  platform: linux darwin
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-gp
  configFile: test/config/tuners/gp.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-grid
  configFile: test/config/tuners/gridsearch.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-hyperband
  configFile: test/config/tuners/hyperband.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py

- name: tuner-metis
  configFile: test/config/tuners/metis.yml
  config:
    maxTrialNum: 2
    trialConcurrency: 2
    useAnnotation: False
    searchSpacePath: ../naive_trial/search_space.json
    trial:
      codeDir: ../naive_trial
      command: python3 trial.py
